<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLAMFLOW AI - GODMODE Control Panel</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000000;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }

        .godmode-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }

        .godmode-sidebar {
            background: #0a0a0a;
            border-right: 2px solid #ff0080;
            padding: 2rem 0;
            overflow-y: auto;
            max-height: 100vh;
            position: sticky;
            top: 0;
        }

        .godmode-logo {
            padding: 0 1.5rem 2rem;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ff0080, #ff8c00, #40e0d0, #00d4ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 5px #ff0080); }
            50% { filter: drop-shadow(0 0 15px #40e0d0); }
        }

        .godmode-menu {
            list-style: none;
        }

        .godmode-menu li {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
            margin: 0.5rem 0;
        }

        .godmode-menu li:hover {
            border-left-color: #ff0080;
            background: rgba(255, 0, 128, 0.1);
            color: #00d4ff;
        }

        .godmode-menu li.active {
            border-left-color: #40e0d0;
            color: #ff0080;
            font-weight: 700;
            background: rgba(64, 224, 208, 0.1);
        }

        .godmode-content {
            padding: 2rem;
            overflow-y: auto;
            max-height: 100vh;
        }

        .godmode-header {
            background: linear-gradient(135deg, #ff0080 0%, #ff8c00 50%, #40e0d0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 2rem;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .control-box {
            background: linear-gradient(135deg, rgba(255, 0, 128, 0.1) 0%, rgba(64, 224, 208, 0.1) 100%);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .control-box h3 {
            color: #ff0080;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(255, 0, 128, 0.1) 100%);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #ff0080;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ff0080, #40e0d0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: #40e0d0;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 2rem 0;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            font-size: 0.95rem;
        }

        .table th {
            background: linear-gradient(135deg, #ff0080, #ff8c00);
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }

        .table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid rgba(0, 212, 255, 0.2);
            color: #00d4ff;
        }

        .table tr:hover {
            background: rgba(0, 212, 255, 0.05);
        }

        .btn-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff0080, #ff8c00);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(255, 0, 128, 0.6);
        }

        .btn-secondary {
            background: rgba(64, 224, 208, 0.2);
            color: #40e0d0;
            border: 1px solid #40e0d0;
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        .btn-danger {
            background: rgba(255, 0, 128, 0.3);
            color: #ff0080;
            border: 1px solid #ff0080;
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            color: #40e0d0;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            background: rgba(0, 212, 255, 0.08);
            border: 1px solid #40e0d0;
            border-radius: 8px;
            padding: 0.75rem;
            color: #00d4ff;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #ff0080;
            box-shadow: 0 0 15px rgba(255, 0, 128, 0.3);
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .status-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-active {
            background: rgba(64, 224, 208, 0.2);
            color: #40e0d0;
        }

        .status-inactive {
            background: rgba(255, 128, 0, 0.2);
            color: #ff8c00;
        }

        .status-suspended {
            background: rgba(255, 0, 128, 0.2);
            color: #ff0080;
        }

        @media (max-width: 768px) {
            .godmode-container {
                grid-template-columns: 1fr;
            }

            .godmode-sidebar {
                max-height: 200px;
                display: flex;
                border-right: none;
                border-bottom: 2px solid #ff0080;
            }

            .godmode-menu {
                display: flex;
                gap: 1rem;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="godmode-container">
        <!-- Sidebar -->
        <div class="godmode-sidebar">
            <div class="godmode-logo">üî• GODMODE</div>
            <ul class="godmode-menu">
                <li class="active" onclick="switchSection('dashboard')">üìä Dashboard</li>
                <li onclick="switchSection('analytics')">üìà Analytics</li>
                <li onclick="switchSection('users')">üë• Users</li>
                <li onclick="switchSection('billing')">üí∞ Billing</li>
                <li onclick="switchSection('settings')">üõ†Ô∏è Settings</li>
                <li onclick="logout()" style="color: #ff0080; margin-top: 2rem;">üö™ Logout</li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="godmode-content">
            <!-- DASHBOARD SECTION -->
            <div id="dashboard" class="section active">
                <div class="godmode-header">üìä Control Center</div>
                
                <div class="stats-grid">
                    <div class="stat-card" onclick="switchSection('users')">
                        <div class="stat-value" id="stat-users">47</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-active">12</div>
                        <div class="stat-label">Active Now</div>
                    </div>
                    <div class="stat-card" onclick="switchSection('analytics')">
                        <div class="stat-value" id="stat-chats">2.4K</div>
                        <div class="stat-label">Total Conversations</div>
                    </div>
                    <div class="stat-card" onclick="switchSection('billing')">
                        <div class="stat-value" id="stat-revenue">$8.2K</div>
                        <div class="stat-label">Monthly Revenue</div>
                    </div>
                </div>

                <div class="control-box">
                    <h3>üéÆ Quick Actions</h3>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="switchSection('users')">‚ûï Add New User</button>
                        <button class="btn btn-primary" onclick="switchSection('analytics')">üìä View Analytics</button>
                        <button class="btn btn-primary" onclick="switchSection('billing')">üí≥ Manage Billing</button>
                        <button class="btn btn-primary" onclick="switchSection('settings')">‚öôÔ∏è Settings</button>
                    </div>
                </div>

                <div class="control-box">
                    <h3>‚ö° System Status</h3>
                    <p style="color: #40e0d0; line-height: 2; font-size: 1.1rem;">
                        ‚úÖ <strong>Platform:</strong> <span style="color: #00d4ff;">ONLINE</span><br>
                        ‚úÖ <strong>Database:</strong> <span style="color: #00d4ff;">HEALTHY</span><br>
                        ‚úÖ <strong>API:</strong> <span style="color: #00d4ff;">OPERATIONAL</span><br>
                        ‚úÖ <strong>Uptime:</strong> <span style="color: #00d4ff;">99.8%</span>
                    </p>
                </div>
            </div>

            <!-- ANALYTICS SECTION -->
            <div id="analytics" class="section">
                <div class="godmode-header">üìà Analytics & Performance</div>
                
                <div class="control-box">
                    <h3>üìä Real-Time Performance Metrics</h3>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>

                <div class="control-box">
                    <h3>üí¨ Daily Conversation Volume</h3>
                    <div class="chart-container">
                        <canvas id="conversationChart"></canvas>
                    </div>
                </div>

                <div class="control-box">
                    <h3>üë• User Growth Trend</h3>
                    <div class="chart-container">
                        <canvas id="userGrowthChart"></canvas>
                    </div>
                </div>

                <div class="control-box">
                    <h3>üéØ Engagement Statistics</h3>
                    <table class="table">
                        <tr>
                            <td style="font-weight: 600;">Avg Response Time</td>
                            <td>234ms <span class="btn btn-secondary" style="float: right;">Edit</span></td>
                        </tr>
                        <tr>
                            <td style="font-weight: 600;">Chatbot Accuracy</td>
                            <td>94.2% <span class="btn btn-secondary" style="float: right;">Edit</span></td>
                        </tr>
                        <tr>
                            <td style="font-weight: 600;">User Satisfaction</td>
                            <td>4.8/5 ‚≠ê <span class="btn btn-secondary" style="float: right;">Edit</span></td>
                        </tr>
                        <tr>
                            <td style="font-weight: 600;">Resolution Rate</td>
                            <td>87% <span class="btn btn-secondary" style="float: right;">Edit</span></td>
                        </tr>
                    </table>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="downloadReport('monthly')">üì• Export Monthly Report</button>
                    <button class="btn btn-primary" onclick="downloadReport('custom')">üì• Custom Report</button>
                </div>
            </div>

            <!-- USERS SECTION -->
            <div id="users" class="section">
                <div class="godmode-header">üë• User Management</div>
                
                <div class="control-box">
                    <h3>üîç Search & Filter Users</h3>
                    <div class="input-row">
                        <input type="text" id="searchUsers" placeholder="Search by email..." onkeyup="filterUsers()">
                        <select id="filterStatus" onchange="filterUsers()">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="suspended">Suspended</option>
                        </select>
                    </div>
                </div>

                <div class="control-box">
                    <h3>‚ûï Create New User</h3>
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" id="newUserEmail" placeholder="user@example.com">
                    </div>
                    <div class="form-group">
                        <label>Business Name</label>
                        <input type="text" id="newUserBusiness" placeholder="Beauty Salon">
                    </div>
                    <div class="form-group">
                        <label>Plan Type</label>
                        <select id="newUserPlan">
                            <option>Free Trial</option>
                            <option>Pro - $29/mo</option>
                            <option>Enterprise - Custom</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="addUser()">‚úÖ Create User</button>
                </div>

                <div class="control-box">
                    <h3>üìã User Directory</h3>
                    <table class="table" id="usersTable">
                        <thead>
                            <tr>
                                <th>Email</th>
                                <th>Business</th>
                                <th>Plan</th>
                                <th>Joined</th>
                                <th>Conversations</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- BILLING SECTION -->
            <div id="billing" class="section">
                <div class="godmode-header">üí∞ Billing & Revenue</div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">$8.2K</div>
                        <div class="stat-label">Monthly Revenue</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">2.1%</div>
                        <div class="stat-label">Churn Rate</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">$175</div>
                        <div class="stat-label">Avg Revenue Per User</div>
                    </div>
                </div>

                <div class="control-box">
                    <h3>üí≥ Manage Subscription Plans</h3>
                    <div class="form-group">
                        <label>Free Plan - Monthly Message Limit</label>
                        <input type="number" id="freePlanLimit" value="1000" placeholder="Messages per month" onchange="savePlanSettings()">
                    </div>
                    <div class="form-group">
                        <label>Pro Plan - Monthly Price</label>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <span style="color: #40e0d0; font-weight: bold;">$</span>
                            <input type="number" id="proPlanPrice" value="29" style="flex: 1;" onchange="savePlanSettings()">
                            <span style="color: #40e0d0; font-weight: bold;">/month</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Enterprise Plan - Monthly Price</label>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <span style="color: #40e0d0; font-weight: bold;">$</span>
                            <input type="number" id="enterprisePlanPrice" value="99" style="flex: 1;" onchange="savePlanSettings()">
                            <span style="color: #40e0d0; font-weight: bold;">/month</span>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="savePlanSettings()">üíæ Save Plan Pricing</button>
                </div>

                <div class="control-box">
                    <h3>üìã Recent Invoices & Transactions</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Invoice #</th>
                                <th>Customer</th>
                                <th>Amount</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="invoicesTable">
                        </tbody>
                    </table>
                </div>

                <div class="control-box">
                    <h3>üí∏ Process Refund Request</h3>
                    <div class="form-group">
                        <label>Customer Email</label>
                        <input type="email" id="refundEmail" placeholder="user@example.com">
                    </div>
                    <div class="form-group">
                        <label>Refund Amount ($)</label>
                        <input type="number" id="refundAmount" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>Reason for Refund</label>
                        <input type="text" id="refundReason" placeholder="Reason for refund">
                    </div>
                    <button class="btn btn-danger" onclick="processRefund()">üí≥ Process Refund</button>
                </div>
            </div>

            <!-- SETTINGS SECTION -->
            <div id="settings" class="section">
                <div class="godmode-header">üõ†Ô∏è Platform Settings</div>
                
                <div class="control-box">
                    <h3>‚öôÔ∏è General Configuration</h3>
                    <div class="form-group">
                        <label>Platform Name</label>
                        <input type="text" id="platformName" value="GLAMFLOW AI" onchange="saveSettings()">
                    </div>
                    <div class="form-group">
                        <label>Support Email Address</label>
                        <input type="email" id="supportEmail" value="support@glamflow.ai" onchange="saveSettings()">
                    </div>
                    <div class="form-group">
                        <label>Trial Period (days)</label>
                        <input type="number" id="trialDays" value="7" min="1" onchange="saveSettings()">
                    </div>
                    <div class="form-group">
                        <label>Max Chatbots Per User</label>
                        <input type="number" id="maxChatbots" value="3" min="1" onchange="saveSettings()">
                    </div>
                </div>

                <div class="control-box">
                    <h3>ü§ñ AI Model Settings</h3>
                    <div class="form-group">
                        <label>AI Model Engine</label>
                        <select id="aiModel" onchange="saveSettings()">
                            <option>GPT-4 Turbo</option>
                            <option>GPT-3.5</option>
                            <option>Claude 3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Response Speed (milliseconds)</label>
                        <input type="number" id="responseSpeed" value="500" min="100" onchange="saveSettings()">
                    </div>
                    <div class="form-group">
                        <label>Creativity/Temperature (0-1)</label>
                        <input type="number" id="temperature" value="0.7" min="0" max="1" step="0.1" onchange="saveSettings()">
                    </div>
                </div>

                <div class="control-box">
                    <h3>üîê Admin Access Control</h3>
                    <div class="form-group">
                        <label>Access Code (what users type)</label>
                        <input type="text" id="accessCode" value="Around360" onchange="saveSettings()">
                    </div>
                    <div class="form-group">
                        <label>Master Key (confirmation password)</label>
                        <input type="password" id="masterKey" value="!!litree!!" onchange="saveSettings()">
                    </div>
                    <button class="btn btn-danger" onclick="changeCredentials()">üîë Update Admin Credentials</button>
                </div>

                <div class="control-box">
                    <h3>üîå Third-Party API Keys</h3>
                    <div class="form-group">
                        <label>Stripe API Key</label>
                        <input type="password" id="stripeKey" placeholder="sk_live_xxxxx" onchange="saveSettings()">
                    </div>
                    <div class="form-group">
                        <label>SendGrid Email API Key</label>
                        <input type="password" id="sendgridKey" placeholder="SG.xxxxx" onchange="saveSettings()">
                    </div>
                    <div class="form-group">
                        <label>OpenAI API Key</label>
                        <input type="password" id="openaiKey" placeholder="sk-xxxxx" onchange="saveSettings()">
                    </div>
                    <button class="btn btn-primary" onclick="saveSettings()">‚úÖ Save All API Keys</button>
                </div>

                <div class="control-box">
                    <h3>‚ö° System Maintenance & Tools</h3>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="systemMaintenance('cache')">üßπ Clear Cache</button>
                        <button class="btn btn-secondary" onclick="systemMaintenance('optimize')">üìä Optimize Database</button>
                        <button class="btn btn-secondary" onclick="systemMaintenance('backup')">üíæ Backup Now</button>
                        <button class="btn btn-secondary" onclick="systemMaintenance('restart')">üîÑ Restart Services</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize data from localStorage
        function initData() {
            const data = JSON.parse(localStorage.getItem('godmodeData')) || {
                users: [
                    { email: 'sarah@salon.com', business: "Sarah's Beauty Salon", plan: 'Pro - $29/mo', joined: '2025-01-15', conversations: 89, status: 'active' },
                    { email: 'maria@makeup.com', business: 'Maria Makeup Artist', plan: 'Pro - $29/mo', joined: '2025-01-10', conversations: 156, status: 'active' },
                    { email: 'jessica@hair.com', business: 'Jessica Hair Studio', plan: 'Enterprise - Custom', joined: '2025-01-08', conversations: 203, status: 'active' },
                    { email: 'lisa@nails.com', business: "Lisa's Nail Spa", plan: 'Pro - $29/mo', joined: '2025-01-05', conversations: 67, status: 'active' },
                    { email: 'emma@skincare.com', business: "Emma's Skincare Clinic", plan: 'Enterprise - Custom', joined: '2025-01-01', conversations: 178, status: 'active' },
                ],
                invoices: [
                    { id: 'INV-001', customer: 'Sarah Johnson', amount: 29, date: '2025-01-28', status: 'Paid' },
                    { id: 'INV-002', customer: 'Maria Garcia', amount: 99, date: '2025-01-27', status: 'Paid' },
                    { id: 'INV-003', customer: 'Jessica Lee', amount: 99, date: '2025-01-26', status: 'Pending' },
                    { id: 'INV-004', customer: 'Lisa Wong', amount: 29, date: '2025-01-25', status: 'Paid' },
                ]
            };
            localStorage.setItem('godmodeData', JSON.stringify(data));
            return data;
        }

        const data = initData();

        // Check admin access
        function checkAdminAccess() {
            const adminToken = sessionStorage.getItem('glamflow_admin_token');
            if (!adminToken) {
                alert('‚ùå Unauthorized access!');
                window.location.href = '/index.html';
                return;
            }
        }

        // Switch sections
        function switchSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.godmode-menu li').forEach(li => li.classList.remove('active'));
            
            document.getElementById(sectionId).classList.add('active');
            
            // Set active menu item
            event.target.classList.add('active');

            if (sectionId === 'analytics') {
                setTimeout(() => {
                    initCharts();
                }, 100);
            } else if (sectionId === 'users') {
                loadUsers();
            } else if (sectionId === 'billing') {
                loadInvoices();
            }
        }

        // Load users
        function loadUsers() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            data.users.forEach((user, idx) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.email}</td>
                    <td>${user.business}</td>
                    <td>${user.plan}</td>
                    <td>${user.joined}</td>
                    <td><input type="number" value="${user.conversations}" style="width: 60px; padding: 0.25rem;" onchange="updateConversations(${idx}, this.value)"></td>
                    <td><span class="status-badge status-${user.status}">${user.status.charAt(0).toUpperCase() + user.status.slice(1)}</span></td>
                    <td>
                        <button class="btn btn-secondary" onclick="editUser(${idx})">‚úèÔ∏è Edit</button>
                        <button class="btn btn-danger" onclick="suspendUser(${idx})">üö´ Suspend</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Add user
        function addUser() {
            const email = document.getElementById('newUserEmail').value;
            const business = document.getElementById('newUserBusiness').value;
            const plan = document.getElementById('newUserPlan').value;

            if (!email || !business) {
                alert('‚ùå Please fill all required fields');
                return;
            }

            const newUser = {
                email, business, plan,
                joined: new Date().toISOString().split('T')[0],
                conversations: 0,
                status: 'active'
            };

            data.users.push(newUser);
            localStorage.setItem('godmodeData', JSON.stringify(data));
            
            alert(`‚úÖ User created successfully!\n\nüìß Email: ${email}\nüè¢ Business: ${business}\nüìã Plan: ${plan}`);
            document.getElementById('newUserEmail').value = '';
            document.getElementById('newUserBusiness').value = '';
            loadUsers();
        }

        // Update conversations
        function updateConversations(idx, value) {
            data.users[idx].conversations = parseInt(value) || 0;
            localStorage.setItem('godmodeData', JSON.stringify(data));
            alert(`‚úÖ Updated ${data.users[idx].email}`);
        }

        // Edit user
        function editUser(idx) {
            const user = data.users[idx];
            const newPlan = prompt('Update plan:', user.plan);
            if (newPlan) {
                user.plan = newPlan;
                localStorage.setItem('godmodeData', JSON.stringify(data));
                loadUsers();
                alert('‚úÖ User plan updated!');
            }
        }

        // Suspend user
        function suspendUser(idx) {
            if (confirm(`‚ö†Ô∏è Toggle suspension for ${data.users[idx].email}?`)) {
                data.users[idx].status = data.users[idx].status === 'suspended' ? 'active' : 'suspended';
                localStorage.setItem('godmodeData', JSON.stringify(data));
                loadUsers();
                alert(`‚úÖ User ${data.users[idx].status === 'suspended' ? 'suspended' : 'reactivated'}`);
            }
        }

        // Filter users
        function filterUsers() {
            const search = document.getElementById('searchUsers').value.toLowerCase();
            const status = document.getElementById('filterStatus').value;
            const rows = document.querySelectorAll('#usersTableBody tr');
            
            rows.forEach(row => {
                const email = row.cells[0].textContent.toLowerCase();
                const rowStatus = row.cells[5].textContent.toLowerCase();
                const matchesSearch = email.includes(search);
                const matchesStatus = !status || rowStatus.includes(status);
                row.style.display = matchesSearch && matchesStatus ? '' : 'none';
            });
        }

        // Load invoices
        function loadInvoices() {
            const tbody = document.getElementById('invoicesTable');
            tbody.innerHTML = '';
            data.invoices.forEach((inv, idx) => {
                const row = document.createElement('tr');
                const statusClass = inv.status === 'Paid' ? 'status-active' : 'status-inactive';
                row.innerHTML = `
                    <td>${inv.id}</td>
                    <td>${inv.customer}</td>
                    <td>$${inv.amount}</td>
                    <td>${inv.date}</td>
                    <td><span class="status-badge ${statusClass}">${inv.status}</span></td>
                    <td><button class="btn btn-secondary" onclick="alert('üì• Downloading invoice ${inv.id}...')">üì• Download</button></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Process refund
        function processRefund() {
            const email = document.getElementById('refundEmail').value;
            const amount = document.getElementById('refundAmount').value;
            const reason = document.getElementById('refundReason').value;

            if (!email || !amount || !reason) {
                alert('‚ùå Please fill all refund fields');
                return;
            }

            alert(`‚úÖ REFUND PROCESSED!\n\nüí∞ Amount: $${amount}\nüìß Customer: ${email}\nüìù Reason: ${reason}\n\n‚úâÔ∏è Confirmation email sent to customer`);
            document.getElementById('refundEmail').value = '';
            document.getElementById('refundAmount').value = '';
            document.getElementById('refundReason').value = '';
        }

        // Save settings
        function saveSettings() {
            const settings = {
                platformName: document.getElementById('platformName').value,
                supportEmail: document.getElementById('supportEmail').value,
                trialDays: document.getElementById('trialDays').value,
                maxChatbots: document.getElementById('maxChatbots').value,
                aiModel: document.getElementById('aiModel').value,
                responseSpeed: document.getElementById('responseSpeed').value,
                temperature: document.getElementById('temperature').value,
                stripeKey: document.getElementById('stripeKey').value,
                sendgridKey: document.getElementById('sendgridKey').value,
                openaiKey: document.getElementById('openaiKey').value,
            };
            localStorage.setItem('platformSettings', JSON.stringify(settings));
            alert('‚úÖ All settings saved successfully!');
        }

        // Save plan settings
        function savePlanSettings() {
            const planSettings = {
                freePlanLimit: document.getElementById('freePlanLimit').value,
                proPlanPrice: document.getElementById('proPlanPrice').value,
                enterprisePlanPrice: document.getElementById('enterprisePlanPrice').value,
            };
            localStorage.setItem('planSettings', JSON.stringify(planSettings));
            alert('‚úÖ Pricing plans updated!');
        }

        // Change credentials
        function changeCredentials() {
            const newCode = prompt('Enter new access code:', document.getElementById('accessCode').value);
            if (newCode) {
                const newKey = prompt('Enter new master key:', document.getElementById('masterKey').value);
                if (newKey) {
                    document.getElementById('accessCode').value = newCode;
                    document.getElementById('masterKey').value = newKey;
                    localStorage.setItem('adminCredentials', JSON.stringify({ code: newCode, key: newKey }));
                    alert(`‚úÖ Credentials updated!\n\nüîë New Access Code: ${newCode}\nüîê New Master Key: ${newKey}`);
                }
            }
        }

        // Download report
        function downloadReport(type) {
            alert(`üìä ${type === 'monthly' ? 'Monthly' : 'Custom'} Report\n\n‚è≥ Generating...\n\nüì• Downloading as PDF...`);
        }

        // System maintenance
        function systemMaintenance(action) {
            const messages = {
                cache: 'üßπ Cache cleared!\n‚ú® All temporary data removed',
                optimize: 'üìä Database optimization started!\nüöÄ Indexes rebuilt',
                backup: 'üíæ Full system backup initiated!\n‚è≥ Backup in progress...',
                restart: 'üîÑ Services restarting!\n‚ö° All systems coming back online'
            };
            alert(`‚úÖ ${messages[action]}`);
        }

        // Initialize charts
        function initCharts() {
            const ctx1 = document.getElementById('performanceChart');
            const ctx2 = document.getElementById('conversationChart');
            const ctx3 = document.getElementById('userGrowthChart');

            if (ctx1 && !window.performanceChart) {
                window.performanceChart = new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Response Time (ms)',
                            data: [234, 245, 212, 298, 267, 289, 234],
                            borderColor: '#ff0080',
                            backgroundColor: 'rgba(255, 0, 128, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: '#40e0d0' } } },
                        scales: { y: { ticks: { color: '#40e0d0' } }, x: { ticks: { color: '#40e0d0' } } }
                    }
                });
            }

            if (ctx2 && !window.conversationChart) {
                window.conversationChart = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Conversations',
                            data: [450, 520, 480, 620, 540, 480, 320],
                            backgroundColor: '#40e0d0',
                            borderColor: '#ff0080',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: '#40e0d0' } } },
                        scales: { y: { ticks: { color: '#40e0d0' } }, x: { ticks: { color: '#40e0d0' } } }
                    }
                });
            }

            if (ctx3 && !window.userGrowthChart) {
                window.userGrowthChart = new Chart(ctx3, {
                    type: 'line',
                    data: {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'],
                        datasets: [{
                            label: 'New Users',
                            data: [12, 19, 15, 25, 22, 30],
                            borderColor: '#ff8c00',
                            backgroundColor: 'rgba(255, 140, 0, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: '#40e0d0' } } },
                        scales: { y: { ticks: { color: '#40e0d0' } }, x: { ticks: { color: '#40e0d0' } } }
                    }
                });
            }
        }

        // Logout
        function logout() {
            if (confirm('üö™ Exit GODMODE and return to login?')) {
                sessionStorage.removeItem('glamflow_admin_token');
                window.location.href = '/index.html';
            }
        }

        // Initialize
        window.addEventListener('load', () => {
            checkAdminAccess();
            loadUsers();
        });
    </script>
</body>
</html>
